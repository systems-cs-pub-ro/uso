===== Get a Life =====

==== 1. Emulare ====
[[http://qemu.org|QEMU]] este un emulator/mașină virtuală care permite rularea unui sistem de operare complet ca un simplu program în cadrul unui alt sistem. A fost dezvoltat inițial de Fabrice Bellard și este disponibil gratuit, sub o licență open source. QEMU poate rula atât pe Linux, cât și pe Windows. Este un emulator deoarece poate rula sisteme de operare și programe compilate pentru o platformă (ex: o placă cu procesor ARM, similară cu ce găsim într-un smartphone) pe o altă platformă (ex: un PC [[https://en.wikipedia.org/wiki/X86|arhitectură x86]] așa cum sunt sistemele din EG306 sau EG106). Acest lucru este făcut prin translatarea dinamică a intrucțiunilor architecturii guest în instrucțiuni pentru arhitectura host.

**[1a]** Rularea unei imagini de Raspbian (arhitectura ARM)

<note important>
Acest exercițiu se desfășoară pe **sistemul fizic**.
</note>

Pentru acest exercițiu sunt necesare:
  * O imagine de kernel Linux pentru arhitectura ARM, descărcabil de [[http://repository.grid.pub.ro/cs/uso/2015-2016/lab09/kernel-qemu|aici]].
  * O imagine de Raspbian (mașină virtuală de Debian care merge pe un sistem de fișiere tip Raspberry Pi), descărcabilă de [[http://repository.grid.pub.ro/cs/uso/2015-2016/lab09/2012-10-28-wheezy-raspbian.zip|aici]]. Folosiți Raspbian Wheezy, un flavor de Ubuntu pentru platforma Raspberry Pi. Dezarhivați imaginea în directorul în care ați descărcat-o folosind comanda<code>
unzip 2012-10-28-wheezy-raspbian.zip
</code>
  * Un set de pachete pentru a rula într-o mașina virtuală QEMU imaginea de Raspbian. Pentru a instala pachetele necesare rulați comanda<code bash>
student@uso~:$ sudo apt-get install qemu qemu-kvm qemu-system-arm
</code>

<note tip>
Există posibilitatea ca în urma rulării comenzii de mai sus să obțineți mesajele de eroare. Mesajul de eroare vă indică ce aveți de făcut, anume actualizarea pachetelor folosind comanda<code>
sudo apt-get update
</code>
după care să rulați din nou comanda de instalare, care va rula acum fără probleme.
</note>

Pentru a rula o distribuție de Linux pentru platforma Raspberry Pi, trebuie rulată următoarea comandă în directorul în care aveți **atât** imaginea de kernel ''kernel-qemu'' cât și imaginea de Raspbian. 

<code bash>
student@uso~:$ qemu-system-arm -kernel kernel-qemu -cpu arm1176 -m 256 -M versatilepb -no-reboot -serial stdio -append "root=/dev/sda2 panic=1 rootfstype=ext4 rw" -hda 2012-10-28-wheezy-raspbian.img
</code>

Să descifrăm fiecare parametru de mai sus:
  * ''-cpu'' - specifică tipul de procesor care va fi emulat
  * ''-m'' - specifică dimensiunea memoriei RAM
  * ''-hda, -hdb'' etc. - specifică imaginea pentru primul hard disk, respectiv al doilea hard disk, ș.a.m.d
  * ''-fda, -fdb'' - specifică imaginea pentru primul floppy disk, respectiv al doilea floppy disk
  * ''-cdrom'' - specifică imaginea folosită de cdrom
  * ''-serial'', ''-parallel'' - specifică porturile seriale, respectiv, paralele și modul de interacțiune a acestora cu host-ul

După bootare vă apare un ecran de configurare. În ecranul apărut mergeți până la butonul ''Finish'' (folosind ''Tab'').

<note>
Dacă nu sunteți autentificați, folosiți următoarele date de autentificare:
   - username: ''pi''
   - parolă: ''raspberry''
</note>

După ce a bootat sistemul de operare din emulatorul QEMU (adică mașina virtuală Raspabian) rulați, în cadrul acestei mașini virtuale, comenzile: <code bash>
$ lscpu
$ uname -a
</code>

<note tip>
Comanda ''lscpu'' s-ar putea să nu vă meargă pentru că nu este montat sistemul de fișiere ''proc'' necesar comenzii ''lscpu''. Pentru a monta acest sistem de fișiere rulați comanda<code>
$ sudo mount -t proc proc /proc
</code>
</note>

Observați că în loc de arhitectura ''x86'' în output (așa cum vedeam la primul exercițiu) avem ca arhitectură ''arm''. Mai multe detalii despre ARM pe [[http://www.arm.com/products/processors/instruction-set-architectures/index.php|site-ul oficial]].

<note> 
**Informativ**: Pentru a scrie imaginea de mai sus pe un card SD și a o rula pe un dispozitiv de tipul [[https://www.raspberrypi.org/|Raspberry Pi]] trebuie să rulăm trei comenzi: una pentru idenficarea partițiilor (e.g. ''df''), una pentru demontarea partiției care repzintă cardul SD și una pentru scrierea imaginii de Raspbian pe cardul SD, folosind ''dd''. Urmăriți [[https://www.raspberrypi.org/documentation/installation/installing-images/linux.md|indicațiile de aici]] dacă nu sunteți siguri ce comenzi trebuie să dați. 
</note>

==== 2. Docker ====
[[http://qemu.org|Docker]] este un program folosit pentru virtualizare la nivelul sistemului de operare, cunoscut si sub numele de "containerization". Docker este folosit pentru a rula pachete software numite ''containere''. Containerele sunt izolate intre ele, dar pot comunica prin diverse canale bine definite. Toate containerele sunt rulate de un singur sistem de operare, fapt ce face Docker mai ''"lightweight"'' decat masinile virtuale clasice.

**[2a]** Instalati Docker pe masina fizica folosind [[https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-convenience-script|ghidul oficial]], varianta de instalare printr-un script.

**[2b]** Clonati repo-ul [[https://github.com/yeasy/simple-web|simple-web]]. Deschideti-l si inspectati fisierele Dockerfile si index.py. Incercati sa intelegi fiecare linie din Dockerfile (intrebati asistentul daca aveti nelamuriri).

**[2c]** Folosind proiectul clonat mai devreme, creati un container folosind Docker. Pentru a va verifica, accesati http://localhost/.

==== 3. Masini virtuale in CLI ====

Pana acum am folosit VirtualBox pentru a importa masini virtuale. Am facut acest lucru din interfata grafica, dar este important de stiut ca putem folosi si linia de comanda, si anume comanda VBoxManage. Urmariti tutorialul de [[https://www.perkin.org.uk/posts/create-virtualbox-vm-from-the-command-line.html|aici]].
